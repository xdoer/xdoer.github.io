<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>å…³äºæé«˜setTimeoutä¸setIntervalç²¾ç¡®åº¦çš„æ¢ç´¢ |
    æ–‡äº«æ—¥å¿—</title>
<meta name="description" content="">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="https://aiyou.life/favicon.ico?v=1631720272735">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://unpkg.com/papercss@1.6.1/dist/paper.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://aiyou.life/styles/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  

<!-- <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script> -->

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


  </head>
  <body>
    <nav class="navbar border fixed split-nav">
  <div class="nav-brand">
    <h3><a href="https://aiyou.life">æ–‡äº«æ—¥å¿—</a></h3>
  </div>
  <div class="collapsible">
    <input id="collapsible1" type="checkbox" name="collapsible1">
    <button>
      <label for="collapsible1">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </label>
    </button>
    <div class="collapsible-body">
      <ul class="inline">
        
          <li>
            
              <a href="/" class="menu">
                é¦–é¡µ
              </a>
            
          </li>
        
          <li>
            
              <a href="/archives" class="menu">
                å½’æ¡£
              </a>
            
          </li>
        
          <li>
            
              <a href="/tags" class="menu">
                æ ‡ç­¾
              </a>
            
          </li>
        
          <li>
            
              <a href="/post/about" class="menu">
                å…³äº
              </a>
            
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div id="top" class="row site">
      <div class="sm-12 md-8 col">
        <div class="paper">
          <article class="article">
            <h1>å…³äºæé«˜setTimeoutä¸setIntervalç²¾ç¡®åº¦çš„æ¢ç´¢</h1>
            <p class="article-meta">
              2019-11-10 
              <a
                href="https://aiyou.life/tag/TDgBvCzI8/"
                class="badge warning"
              >
                javascript
              </a>
              
            </p>
            
            <img src="https://aiyou.life/post-images/kokne79MF.png" alt="å…³äºæé«˜setTimeoutä¸setIntervalç²¾ç¡®åº¦çš„æ¢ç´¢" />
            
            <div class="post-content"><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒsetTimeoutä¸setIntervaléƒ½ä¸æ˜¯ç²¾ç¡®çš„è®¡æ—¶å™¨ï¼Œå®ƒè¿˜ä¸å½“å‰ä¸»çº¿ç¨‹ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡å¤§å°æ•°é‡æœ‰å…³ã€‚å½“ä¸»çº¿ç¨‹ä»»åŠ¡é˜Ÿåˆ—çš„ä»»åŠ¡æ²¡æœ‰æ‰§è¡Œå®Œæ¯•æ—¶,setTimeoutä¸setIntervalå°±ä¸ä¼šå‡†ç¡®çš„åœ¨ t æ—¶é—´åè¿è¡Œã€‚é‚£æ€ä¹ˆæ‰èƒ½æé«˜äºŒè€…çš„ç²¾ç¡®åº¦å‘¢?</p>
<!-- more -->
<h2 id="1-settimeoutsetintervalç”¨æ³•">1. setTimeout/setIntervalç”¨æ³•</h2>
<p>è¿™é‡Œè¿˜æ˜¯ç®€å•æä¸€å˜´å§ã€‚è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯å®šæ—¶å™¨å‡½æ•°ï¼ŒsetTimeoutè¡¨ç¤ºå›è°ƒå‡½æ•°åœ¨ t æ—¶é—´åè¿è¡Œï¼ŒsetIntervalè¡¨ç¤ºå›è°ƒå‡½æ•°æ¯éš” t æ—¶é—´è¿è¡Œã€‚</p>
<pre><code class="language-javascript">setTimeout(function(){
    ...
}, t)

setInterval(function(){
    ...
}, t)
</code></pre>
<div style="text-align:center;font-size:80%">ä»£ç  1.1</div>
<p>åœ¨ CSS3/HTML5ä¹‹å‰ï¼ŒäºŒè€…å¸¸ç”¨æ¥ç»˜åˆ¶é¡µé¢åŠ¨ç”»ã€‚CSS3/HTML5ä¹‹åï¼Œå¸¸ç”¨cssæ¥ç»˜åˆ¶åŠ¨ç”»ã€‚å¦å¤–è¿˜ä¸€ä¸ªAPIæ˜¯requestAnimationFrame. è¯¥å‡½æ•°ä¸setIntervalç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºè¯¥å‡½æ•°æ²¡æœ‰ t å‚æ•°ï¼Œé»˜è®¤æ˜¯å±å¹•åˆ·æ–°çš„æ¯å¸§è°ƒç”¨ä¸€æ¬¡ã€‚æ¯ç§’è°ƒç”¨ï¼ˆ1/å±å¹•åˆ·æ–°ç‡ï¼‰æ¬¡</p>
<pre><code class="language-javascript">requestAnimationFrame(function(){
    // DOMåŠ¨ç”»
})
</code></pre>
<div style="text-align:center;font-size:80%">ä»£ç  1.2</div>
<h2 id="2-å‘ç°é—®é¢˜">2. å‘ç°é—®é¢˜</h2>
<p>Jsæ˜¯ä¸€ä¸ªå•çº¿ç¨‹è¯­è¨€ï¼ŒåŒä¸€æ—¶é—´åªèƒ½åšåŒä¸€ä»¶äº‹æƒ…ã€‚è¿™å¾ˆå¥½ç†è§£ï¼Œå¦‚æœåŒä¸€æ—¶é—´èƒ½åšå¤šä¸ªä»»åŠ¡ï¼Œé‚£ä¹ˆå¤šä»»åŠ¡éƒ½åœ¨æ“ä½œDOMæ—¶ï¼Œé¡µé¢è¯¥æ€ä¹ˆæ˜¾ç¤ºå‘¢?å› è€ŒJSè®¾è®¡ä¸ºäº†å•çº¿ç¨‹,ä½†å•çº¿ç¨‹ä¹Ÿå¸¦æ¥äº†ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚çº¿ç¨‹é˜»å¡ï¼ŒCPUåˆ©ç”¨ç‡ä¸é«˜ç­‰é—®é¢˜ã€‚çœ‹ä»£ç 2.1</p>
<pre><code class="language-javascript">setTimeout(function () {
    console.log('task finished after ' + (Date.now() - startTime) + 'ms')
}, 0)

for (let i = 0 ; i &lt; 9000 ; i++) {
    console.log(5 + 8 + 8 + 8)
}
console.log('ä¸»çº¿ç¨‹å¤æ‚ä»»åŠ¡è€—æ—¶:' + (Date.now() - startTime) + 'ms')
</code></pre>
<div style="text-align:center;font-size:80%">ä»£ç  2.1</div>
<p>æ‰§è¡Œç»“æœå¦‚å›¾ 2.1 æ‰€ç¤º<br>
<img src="https://aiyou.life/post-images/1573436890372.png" alt="" loading="lazy"></p>
<div style="text-align:center;font-size:80%">å›¾ 2.1</div>
<p>forå¾ªç¯æ˜¯ä¸€ä¸ªè€—æ—¶ä»»åŠ¡,é˜»å¡äº†setTimeoutçš„æ‰§è¡Œã€‚æˆ‘ä»¬è®¾å®š0ç§’åæ‰§è¡Œè¾“å‡ºï¼Œå¯å®é™…ç»“æœæ˜¯åœ¨1243msä¹‹åè¾“å‡ºï¼Œæ‰€ä»¥setTimeoutçš„ t å‚æ•°å®šæ—¶ä¸å¤Ÿç²¾ç¡®ã€‚</p>
<!-- **ç»“è®º**: *ä¸»çº¿ç¨‹é‡Œå®é™…ä¸Šæ˜¯æ²¡æœ‰åŠæ³•ç²¾ç¡®æŒ‰æ—¶æ‰§è¡ŒsetTimeout/setIntervalçš„å›è°ƒå‡½æ•°ã€‚å½“æµè§ˆå™¨jså¼•æ“è§£æä»£ç é‡åˆ° setTimeout/setInterval æ—¶ï¼Œä¼šå°†ä»–ä»¬æ³¨å†Œåˆ°ä¸‹ä¸€ä¸ªå®ä»»åŠ¡é˜Ÿåˆ—ï¼Œåªæœ‰æ‰§è¡Œå®Œå½“å‰å®ä»»åŠ¡é˜Ÿåˆ—å’Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡åï¼Œæ‰ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚ä»£ç çš„æ‰§è¡Œæœ¬èº«å°±æ¶ˆè€—æ—¶é—´*ã€‚ -->
<p>å…³äºäº‹ä»¶å¾ªç¯ã€å®ä»»åŠ¡ã€å¾®ä»»åŠ¡ä¸æ˜¯æœ¬æ–‡é‡ç‚¹ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« <a href="https://juejin.im/post/5bac87b6f265da0a906f78d8">ç¬”è¯•é¢˜â€”â€”JavaScriptäº‹ä»¶å¾ªç¯æœºåˆ¶ï¼ˆevent loopã€macrotaskã€microtaskï¼‰</a></p>
<p>é‚£ä¹ˆåˆ°åº•è¦æ€ä¹ˆè§£å†³ç²¾ç¡®åº¦é—®é¢˜å‘¢?</p>
<h2 id="3-è§£å†³é—®é¢˜">3. è§£å†³é—®é¢˜</h2>
<p>å‰æ–‡æˆ‘ä»¬ä¸€ç›´åœ¨æåŠä¸»çº¿ç¨‹ä¸»çº¿ç¨‹çš„ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•åˆ©ç”¨å…¶å®ƒçº¿ç¨‹è¿›è¡Œè®¡æ—¶å‘¢?å½“ä»£ç æ‰§è¡Œåˆ°ç‰¹å®šä½ç½®ï¼Œé€šçŸ¥å…¶å®ƒçº¿ç¨‹ä¸­å¼€å§‹è®¡æ—¶ä»»åŠ¡ï¼Œä¸»çº¿ç¨‹ç»§ç»­å®Œæˆå¤æ‚ä»»åŠ¡ï¼Œé‚£ä¹ˆå°±ä¸ä¼šé˜»å¡è®¡æ—¶å™¨çš„è¿è¡Œï¼Œè¿™æ ·çš„è¯è®¡æ—¶ç²¾ç¡®åº¦å°±æé«˜äº†ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒJSä¸æ˜¯ä¸€é—¨å•çº¿ç¨‹è¯­è¨€å—ï¼Œæ€ä¹ˆèƒ½åˆ©ç”¨é™¤äº†ä¸»çº¿ç¨‹ä¹‹å¤–çš„å…¶ä»–çº¿ç¨‹å‘¢?</p>
<p>åœ¨HTML5ä¸­ï¼Œ<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Worker">Worker</a>çš„å¼•å…¥ä½¿å¾—æˆ‘ä»¬æœ‰äº†åˆ©ç”¨å…¶å®ƒçº¿ç¨‹çš„èƒ½åŠ›ã€‚æ³¨æ„:<strong>Workerä¸­ä¸èƒ½æ“ä½œDOM</strong>ã€‚</p>
<p>äº‹æƒ…å¥½åŠäº†ã€‚æ´‹æ´‹æ´’æ´’å†™ä¸‹å¦‚ä¸‹ä»£ç :</p>
<pre><code class="language-javascript">// workerç”Ÿæˆå™¨
const createWorker = (fn, options) =&gt; {
    const blob = new Blob(['(' + fn.toString() + ')()']);
    const url = URL.createObjectURL(blob);
    if (options) {
        return new Worker(url, options);
    }
    return new Worker(url);
} 
// ç”Ÿæˆworker
const worker = createWorker(function () {
    onmessage = function(e) {
        console.log('è¿›å…¥WebWorker')
        let count = 1
        let startTime = Date.now()
        let timer = setInterval(function () {
            if (count++ === e.data) {
                clearInterval(timer)
                postMessage(startTime)
            }
        }, 1000)
    }
})

// å°†ä»£ç 2.1ä¸­çš„setTimeoutæ›¿æ¢ä¸ºäº† worker
// workerçº¿ç¨‹ä»»åŠ¡
const startTime = Date.now()
worker.postMessage(10)
worker.onmessage = function (e) {
    console.log('Workerçº¿ç¨‹ä»»åŠ¡å†…éƒ¨è€—æ—¶:' + (Date.now() - e.data) + 'ms')
    console.log('Workerçº¿ç¨‹ä»»åŠ¡è€—æ—¶:'+ (Date.now() - startTime) + 'ms')
    this.terminate()
}
// ä¸»çº¿ç¨‹ä»»åŠ¡
for (let i = 0 ; i &lt; 5000 ; i++) {
    console.log(5 + 8 + 8 + 8)
} 
console.log('ä¸»çº¿ç¨‹å¤æ‚ä»»åŠ¡è€—æ—¶:' + (Date.now() - startTime) + 'ms')
</code></pre>
<div style="text-align:center;font-size:80%">ä»£ç  3.1</div>
<p>ä»£ç ä¸­, worker çº¿ç¨‹æ¯ç§’è¿è¡Œä¸€æ¬¡å›è°ƒå‡½æ•°ï¼Œè¿›è¡Œè®¡æ•°ï¼Œå½“å›è°ƒå‡½æ•°æ‰§è¡Œäº† 10 æ¬¡æ—¶ï¼Œé€šçŸ¥ä¸»çº¿ç¨‹ã€‚ä¸»çº¿ç¨‹æ‰“å° worker çº¿ç¨‹è¿è¡Œæ—¶é—´ã€‚</p>
<p>ä»£ç è¿è¡Œç»“æœå¦‚å›¾3.1æ‰€ç¤º<br>
<img src="https://aiyou.life/post-images/1573401585223.png" alt="" loading="lazy"></p>
<div style="text-align:center;font-size:80%">å›¾ 3.1</div>
<p>è¿è¡Œç»“æœå¹¶ä¸ç¬¦åˆé¢„æœŸã€‚é¢„æœŸç»“æœåº”å½“æ˜¯<strong>Workerçº¿ç¨‹ä»»åŠ¡å†…éƒ¨è€—æ—¶</strong>ä¸<strong>Workerçº¿ç¨‹ä»»åŠ¡è€—æ—¶</strong>ç›¸å·®ä¸å¤šã€‚å‡ºç°è¿™ä¸ªç»“æœçš„åŸå› åœ¨äºjsä»£ç åœ¨æ‰§è¡Œåˆ°<code>worker.postMessage(10)</code>æ—¶,å¹¶æ²¡æœ‰é€šçŸ¥åˆ°Workerå¼€å§‹å·¥ä½œï¼Œè€Œæ˜¯ç­‰å¾…å½“å‰ä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œå®Œæ¯•ï¼Œæ‰å¼€å§‹è°ƒç”¨ WorkerğŸ˜­..è¿™é‡Œä¸åƒfetchå‡½æ•°é‚£æ ·ï¼Œä»£ç æ‰§è¡Œåˆ°fetchæ—¶,æµè§ˆå™¨å¦å¼€çº¿ç¨‹å»å¤„ç†è¯·æ±‚ï¼Œæ‹¿åˆ°ç»“æœå†è¿›è¡Œå›è°ƒ,å…¶ä»–ä»£ç æ¥ç€è¿è¡Œã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜åˆæ¥äº†,workeræ˜¯å±äºå®ä»»åŠ¡è¿˜æ˜¯å¾®ä»»åŠ¡å‘¢?<br>
éªŒè¯ä»£ç å¦‚ä¸‹:</p>
<pre><code class="language-javascript">...
setTimeout(()=&gt;{
    console.log('SetTimeout')
}, 0)
const worker = createWorker(function () {
    onmessage = function(e) {
    console.log('è¿›å…¥WebWorker ')
    let count = 1
    let startTime = Date.now()
    let timer = setInterval(function () {
            if (count++ === e.data) {
                clearInterval(timer)
                postMessage(startTime)
            }
        }, 1000)
    }
})
...
</code></pre>
<div style="text-align:center;font-size:80%">ä»£ç  3.2</div>
<p>è¿è¡Œç»“æœå¦‚ä¸‹:<br>
<img src="https://aiyou.life/post-images/1573403893208.png" alt="" loading="lazy"></p>
<div style="text-align:center;font-size:80%">å›¾ 3.2</div>
<p><code>SetTimeout</code>åœ¨<code>è¿›å…¥WebWorker</code>ä¹‹å‰è¾“å‡º,è¯´æ˜<strong>Workeræ˜¯å®ä»»åŠ¡</strong></p>
<h2 id="4-æ›´è¿›ä¸€æ­¥">4. æ›´è¿›ä¸€æ­¥</h2>
<p>ä¸Šä¸€èŠ‚ä¸­,æˆ‘ä»¬è€ƒè™‘å°†è®¡æ—¶å™¨å‡½æ•°ä¸¢åˆ°Workerä¸­å»æ‰§è¡Œ.ä½†å®é™…è¿è¡Œç»“æœå¹¶ä¸ç¬¦åˆé¢„æœŸã€‚é‚£æˆ‘ä»¬æ¢ä¸€ç§æ€è·¯ï¼Œå°†ä¸»çº¿ç¨‹è€—æ—¶ä»»åŠ¡ä¸¢åˆ°Workeræ‰§è¡Œï¼Œè®¡æ—¶å™¨ç²¾åº¦ä¼šæé«˜å—?ç­”æ¡ˆæ˜¯è‚¯å®šçš„<br>
çœ‹å¦‚ä¸‹ä»£ç 4.1:</p>
<pre><code class="language-javascript">const startTime = Date.now()
setTimeout(function () {
    console.log('task finished after ' + (Date.now() - startTime) + 'ms')
}, 0)
// å°†ä»£ç 2.1ä¸­çš„è€—æ—¶ä»»åŠ¡æ”¾åˆ°worker
const createWorker = (fn, options) =&gt; {
    const blob = new Blob(['(' + fn.toString() + ')()']);
    const url = URL.createObjectURL(blob);
    if (options) {
        return new Worker(url, options);
    }
    return new Worker(url);
}
const worker = createWorker(function () {
    const startTime = Date.now()
    for (let i = 0; i &lt; 9000; i++) {
        console.log(5 + 8 + 8 + 8)
        if (i === 9000 - 1) {
            postMessage(startTime)
        }
    }
})
worker.postMessage('start')
worker.onmessage = function (e) {
    console.log('Workerçº¿ç¨‹ä»»åŠ¡å†…éƒ¨è€—æ—¶:' + (Date.now() - e.data) + 'ms')
    console.log('Workerçº¿ç¨‹ä»»åŠ¡è€—æ—¶:'+ (Date.now() - startTime) + 'ms')
    this.terminate()
}
</code></pre>
<div style="text-align:center;font-size:80%">ä»£ç  4.1</div>
<p>è¿è¡Œç»“æœå¦‚å›¾4.1:<br>
<img src="https://aiyou.life/post-images/1573437200815.png" alt="" loading="lazy"></p>
<div style="text-align:center;font-size:80%">å›¾ 4.1</div>
<p>å¯¹æ¯”ä¸Šæ–‡ä»£ç 2.1,å¯ä»¥çœ‹åˆ°è®¡æ—¶å™¨ç²¾åº¦æé«˜äº†ä¸å°‘ã€‚</p>
<p>å°†Workeræ›¿æ¢æˆsetTimeoutè¯•è¯•</p>
<pre><code class="language-javascript">const startTime = Date.now()
setTimeout(function () {
    console.log('task finished after ' + (Date.now() - startTime) + 'ms')
}, 0)
// å°†ä»£ç 2.1ä¸­è€—æ—¶ä»»åŠ¡æ”¾åˆ°setTimeoutä¸­
setTimeout(function () {
    for (let i = 0 ; i &lt; 9000 ; i++) {
        console.log(5 + 8 + 8 + 8)
    }
    console.log('ä¸»çº¿ç¨‹å¤æ‚ä»»åŠ¡è€—æ—¶:' + (Date.now() - startTime) + 'ms')
}, 0)
</code></pre>
<div style="text-align:center;font-size:80%">ä»£ç  4.2</div>
<p>è¿è¡Œç»“æœå¦‚å›¾4.2:<br>
<img src="https://aiyou.life/post-images/1573808921223.png" alt="" loading="lazy"></p>
<div style="text-align:center;font-size:80%">å›¾ 4.2</div>
<p>å¯¹æ¯”ä¸Šæ–‡ä»£ç 2.1,å¯ä»¥çœ‹åˆ°è®¡æ—¶å™¨ç²¾åº¦ä¹Ÿæé«˜äº†ä¸å°‘ã€‚</p>
<p><strong>æ€»ç»“</strong>:<em>ä¸»çº¿ç¨‹é‡åˆ°è€—æ—¶ä»»åŠ¡ï¼Œåº”å½“è€ƒè™‘å°†å…¶ä¸¢åˆ°ä¸‹ä¸€ä¸ªå®ä»»åŠ¡ä¸­å»æ‰§è¡Œï¼Œè¿™æ ·ä¸ä¼šé˜»å¡å½“å‰ä»»åŠ¡é˜Ÿåˆ—çš„æ‰§è¡Œã€‚é¢˜ç›®ä¸­è®²åˆ°è¦æé«˜è®¡æ—¶å™¨å‡½æ•°ç²¾åº¦ï¼Œå®é™…è®¡æ—¶å™¨ä¹Ÿæ˜¯ä¸€ä¸ªå®ä»»åŠ¡ã€‚è®¡æ—¶å™¨ä¸è€—æ—¶ä»»åŠ¡åœ¨ä¸¢åˆ°ä¸‹ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼Œè¦ä¿è¯è®¡æ—¶å™¨ä»»åŠ¡åœ¨å‰ï¼Œè¿™æ ·å°±å¯ä»¥æé«˜è®¡æ—¶å™¨ç²¾åº¦ã€‚å†è€…ï¼Œè®¡æ—¶å™¨å‡½æ•°è¦å°½é‡é å‰ï¼Œå…ˆäºå…¶ä»–ä»£ç æ‰§è¡Œï¼Œå› ä¸ºä»£ç æ‰§è¡Œæœ¬èº«ä¹Ÿä¼šæ¶ˆè€—æ—¶é—´</em>ã€‚</p>
<h2 id="5-æœ€ä½³å®æˆ˜">5. æœ€ä½³å®æˆ˜</h2>
<p>ä¸»çº¿ç¨‹é‡åˆ°æ— å…³DOMçš„è€—æ—¶ä»»åŠ¡æ—¶ï¼Œåº”å½“é¦–å…ˆè€ƒè™‘ä½¿ç”¨Workerè¿›è¡Œå¤„ç†ä¸è®¡ç®—ã€‚è¿™æ ·æ‰ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚ä»£ç 4.2ä¸­ï¼Œæˆ‘ä»¬å°è¯•å°†è€—æ—¶ä»»åŠ¡æ”¾åˆ°ä¸»çº¿ç¨‹çš„ä¸­çš„ä¸‹ä¸€ä¸ªå®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœä»»åŠ¡æœ‰ä¸Šä¸‡æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œè¿˜æ˜¯ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚Workerè™½ç„¶å±äºå®ä»»åŠ¡ï¼Œä½†åªæ˜¯å°†æ•°æ®ä¼ è¾“åˆ°Workerçº¿ç¨‹ï¼Œç”±Workerè¿›è¡Œè®¡ç®—ã€‚è®¡ç®—å®Œæˆåï¼Œé€šçŸ¥ä¸»çº¿ç¨‹ã€‚</p>
<h2 id="6-å®ç°ä¸€ä¸ªç›¸å¯¹ç²¾ç¡®çš„setinterval">6. å®ç°ä¸€ä¸ªç›¸å¯¹ç²¾ç¡®çš„setInterval</h2>
<pre><code class="language-javascript">function loop(fn, interval) {
    const startTime = Date.now()
    let count = 0
    let currentInterval = interval
    let timer = 0
    function inner() {
        count++
        let offset = new Date().getTime() - (startTime + count * interval)
        currentInterval = interval - offset
        console.log('ä»£ç æ‰§è¡Œæ—¶é—´ï¼š' + offset, 'ä¸‹æ¬¡å¾ªç¯é—´éš”' + currentInterval)
        timer = setTimeout(inner, currentInterval)
        fn(timer)
    }
    setTimeout(inner, currentInterval)
}

let count = 0
loop(function (timer) {
    console.log('å¤–éƒ¨å‡½æ•°')
    if (count++ === 10) {
        console.log('å¤–éƒ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•')
        clearTimeout(timer)
    }
}, 1000)
</code></pre>
<p>å¦‚ä¸Šä»£ç ,æˆ‘ä»¬æ„é€ äº†ä¸€ä¸ªä¸<code>setInterval</code>å‡½æ•°åŠŸèƒ½ç±»ä¼¼çš„loopå‡½æ•°ã€‚æ’å…¥ä¸»çº¿ç¨‹çš„ä»»åŠ¡çš„æ—¶é—´æ’é™¤äº†ä»£ç çš„æ‰§è¡Œæ—¶é—´,ç›¸å¯¹äºsetIntervalç²¾åº¦æé«˜äº†å¾ˆå¤šã€‚ä½†å½“ä»£ç çš„æ‰§è¡Œæ—¶é—´å¤§äºè®¾å®šçš„tæ—¶,ä¸»çº¿ç¨‹æ’å…¥ä»»åŠ¡æ—¶é—´ä¹Ÿä¸ä¼šå‡†ã€‚</p>
<h2 id="7-åè®°">7. åè®°</h2>
<p>è¿™ä¸ªé—®é¢˜æ¥è‡ªäºå…¬ä¼—å·ä¸Šçœ‹åˆ°çš„æŸå¤§å‚çš„é¢è¯•é¢˜ã€‚å› è€Œå¼•å‘äº†ä¸€ç³»åˆ—æ€è€ƒä¸æ¢è®¨ï¼Œé¡ºä¾¿ç ”ç©¶äº†ä¸€ä¸‹WebWorkerã€‚å…¶å®æé«˜setTimeoutä¸setIntervalè®¡æ—¶ç²¾ç¡®åº¦æœ¬èº«æ˜¯ä¸€ä»¶æ— æ„ä¹‰çš„äº‹æƒ…ï¼Œå®é™…ä¸­æœ¬å°±æ²¡æœ‰è¿™æ ·çš„åº”ç”¨åœºæ™¯ï¼Œä½†æ¢ç´¢çš„è¿‡ç¨‹è¿˜æ˜¯è›®æœ‰æ„ä¹‰çš„(å°±æ˜¯æœ‰ç‚¹è€—è´¹å¤´å‘ğŸ˜­)ã€‚ã€‚</p>
</div>
          </article>
          <div class="simple-share">
            <a class="share-item" href="javascript:share.qzone()">QQç©ºé—´</a>
            <a class="share-item" href="javascript:share.weibo()">å¾®åš</a>
            <a class="share-item" href="javascript:share.facebook()"
              >Facebook</a
            >
            <a class="share-item" href="javascript:share.twitter()">Twitter</a>
          </div>
        </div>
        <div class="paper" data-aos="fade-in">
          
          <div class="next-post">
            <div class="next">
              ä¸‹ä¸€ç¯‡
            </div>
            <a href="https://aiyou.life/post/uhJjH7paD/">
              <h3 class="post-title">åˆ©ç”¨Grideaç”ŸæˆGitHubPageé™æ€åšå®¢</h3>
            </a>
          </div>
          
        </div>
         
        <div class="paper" data-aos="fade-in">
          <div id="gitalk-container"></div>
        </div>
          
      </div>

      <div class="sm-12 md-4 col sidebar">
  <div class="paper info-container">
    <img
      src="https://aiyou.life/images/avatar.png?v=1631720272735"
      class="no-responsive avatar"
    />
    <div class="text-muted"></div>
    <div class="social-container">
       
      <a href="https://github.com/xdoer" target="_blank">
        <i class="fab fa-github"></i>
      </a>
        
      <a href="https://twitter.com/xxdoer1" target="_blank">
        <i class="fab fa-twitter"></i>
      </a>
        
      <a href="https://weibo.com/u/7407806835" target="_blank">
        <i class="fab fa-weibo"></i>
      </a>
          
      <a href="https://www.facebook.com/xxdoer" target="_blank">
        <i class="fab fa-facebook"></i>
      </a>
       
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      æœ€æ–°æ–‡ç« 
    </div>
    <div class="row">
      <ul>
         
        <li>
          <a href="https://aiyou.life/post/zPGtmQi-5/">TS çš„ä¸€äº›é«˜çº§ç±»å‹å†™æ³•</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/QqaRhC3Gf/">Restful-API çš„ä¸€ç§åŠ¨æ€ç”Ÿæˆæ•°æ®ç±»å‹çš„æ–¹æ³•</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/SV2erlm_4/">å‡ ä¸ªDemo çœ‹æ‡‚ ESM ä¸ CommonJS å·®å¼‚</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/UNWTwtWxa/">Taro è‡ªå®šä¹‰ showModal</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/iWhkaOqqO/">å†™ä¸€ä¸ªå€’è®¡æ—¶ğŸ˜¢ï¼Ÿ</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/4XYWTWTx/">æƒ³åˆ°çš„ä¸€äº›å¾ˆå¥½çš„é¢è¯•é¢˜</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/M4RcI3wfU/">ç”±å°è£…ä¸€ä¸ªè¯·æ±‚åº“æ‰€æƒ³åˆ°çš„</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/ZSut5c_dE/">Fower: ä¸€ä¸ªå¤šå¹³å°åŸå­ç±» CSS In JS æ ·å¼åº“</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/FkN_iGcYQ/">Taroå°ç¨‹åºå¼€å‘æå‡æ•ˆç‡çš„å‡ ç‚¹åˆ†äº«-è·¯ç”±ç¯‡</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/FEu-GtOkz/">ReactNativeæ¸è¿›å¼å›¾ç‰‡åŠ è½½</a>
        </li>
                             
      </ul>
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      æ ‡ç­¾åˆ—è¡¨
    </div>
    <div class="row">
      
      <a
        href="https://aiyou.life/tag/df67loo-n/"
        class="badge secondary"
      >
        ç¬”è®°
      </a>
      
      <a
        href="https://aiyou.life/tag/K1r5vpFd_/"
        class="badge secondary"
      >
        å‰ç«¯
      </a>
      
      <a
        href="https://aiyou.life/tag/E75leUW9b/"
        class="badge success"
      >
        typescript
      </a>
      
      <a
        href="https://aiyou.life/tag/rSf0tu2pz/"
        class="badge success"
      >
        React
      </a>
      
      <a
        href="https://aiyou.life/tag/TfrzxMzWY/"
        class="badge secondary"
      >
        å°ç¨‹åº
      </a>
      
      <a
        href="https://aiyou.life/tag/TDgBvCzI8/"
        class="badge "
      >
        javascript
      </a>
      
      <a
        href="https://aiyou.life/tag/g_6wyy_ol/"
        class="badge secondary"
      >
        ç½‘ç»œ
      </a>
      
      <a
        href="https://aiyou.life/tag/jp41-NU1u/"
        class="badge success"
      >
        ReactNative
      </a>
      
      <a
        href="https://aiyou.life/tag/X7Cdzy-Hu/"
        class="badge secondary"
      >
        åšå®¢
      </a>
      
    </div>
  </div>
  <div class="paper">
    Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> |
    <a class="rss" href="https://aiyou.life/atom.xml" target="_blank"
      >RSS</a
    >
  </div>
</div>

    </div>

    
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
<!-- <script src="//cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-bash.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-typescript.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-jsx.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-tsx.min.js"></script> -->
<script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">
  AOS.init()

  // hljs.initHighlightingOnLoad()

</script>

<script type="application/javascript">
  // ä¸€è¨€
  function oneWord(element) {
    if (!element) return
    const xhr = new XMLHttpRequest()
    xhr.open('get', 'https://v1.hitokoto.cn/')
    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4) {
        element.innerText = JSON.parse(xhr.responseText).hitokoto
      }
    }
    xhr.send()
  }
  oneWord(document.querySelector('.text-muted'))
</script>

<script type="application/javascript">
  // åˆ†äº«
  var SimpleShare = function (options) {
    // get share content
    options = options || {}
    var url = options.url || window.location.href
    var title = options.title || document.title
    var content = options.content || ''
    var pic = options.pic || ''

    // fix content format
    url = encodeURIComponent(url)
    title = encodeURIComponent(title)
    content = encodeURIComponent(content)
    pic = encodeURIComponent(pic)

    // share target url
    var qzone =
      'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={url}&title={title}&pics={pic}&summary={content}'
    var weibo =
      'http://service.weibo.com/share/share.php?url={url}&title={title}&pic={pic}&searchPic=false'
    var tqq =
      'http://share.v.t.qq.com/index.php?c=share&a=index&url={url}&title={title}&appkey=801cf76d3cfc44ada52ec13114e84a96'
    var renren =
      'http://widget.renren.com/dialog/share?resourceUrl={url}&srcUrl={url}&title={title}&description={content}'
    var douban =
      'http://www.douban.com/share/service?href={url}&name={title}&text={content}&image={pic}'
    var facebook =
      'https://www.facebook.com/sharer/sharer.php?u={url}&t={title}&pic={pic}'
    var twitter = 'https://twitter.com/intent/tweet?text={title}&url={url}'
    var linkedin =
      'https://www.linkedin.com/shareArticle?title={title}&summary={content}&mini=true&url={url}&ro=true'
    var weixin = 'http://qr.topscan.com/api.php?text={url}'
    var qq =
      'http://connect.qq.com/widget/shareqq/index.html?url={url}&desc={title}&pics={pic}'

    // replace content functions
    function replaceAPI(api) {
      api = api.replace('{url}', url)
      api = api.replace('{title}', title)
      api = api.replace('{content}', content)
      api = api.replace('{pic}', pic)

      return api
    }

    // share target
    this.qzone = function () {
      window.open(replaceAPI(qzone))
    }
    this.weibo = function () {
      window.open(replaceAPI(weibo))
    }
    this.tqq = function () {
      window.open(replaceAPI(tqq))
    }
    this.renren = function () {
      window.open(replaceAPI(renren))
    }
    this.douban = function () {
      window.open(replaceAPI(douban))
    }
    this.facebook = function () {
      window.open(replaceAPI(facebook))
    }
    this.twitter = function () {
      window.open(replaceAPI(twitter))
    }
    this.linkedin = function () {
      window.open(replaceAPI(linkedin))
    }
    this.qq = function () {
      window.open(replaceAPI(qq))
    }
    this.weixin = function (callback) {
      if (!callback) {
        window.open(replaceAPI(weixin))
      } else {
        callback(replaceAPI(weixin))
      }
    }
  }
  var share = new SimpleShare()
</script>



<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script>
  var gitalk = new Gitalk({
    clientID: 'f9e29934c5621e13bb13',
    clientSecret: '6ca4b35e60834188ea98ca3be6fba3c21b5ad34a',
    repo: 'xdoer.github.io',
    owner: 'xdoer',
    admin: ['xdoer'],
    id: location.pathname.substring(0, 49), // Ensure uniqueness and length less than 50
    distractionFreeMode: false, // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')
</script>
  
<script>
  // ç‚¹å‡»æ–‡ç« å†…éƒ¨å›¾ç‰‡æŸ¥çœ‹å¤§å›¾
  const contentImagesEles = [...document.querySelectorAll('.post-content img')]
  const maskEle = document.querySelector('prev-mask')
  const containerEle = document.querySelector('image-container')
  const imgCloseEle = document.querySelector('img-close')
  const imgBigEle = document.querySelector('img-big')

  contentImagesEles.forEach((ele) => {
    ele.addEventListener('click', () => {
      const { currentSrc } = ele
      imgBigEle.attributes.currentSrc = currentSrc
      mask.style.display = 'block'
    })
  })

  imgCloseEle.addEventListener('click', () => {
    mask.style.display = 'none'
  })
</script>

  </body>
</html>
