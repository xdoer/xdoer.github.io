<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

<title>Restful-API çš„ä¸€ç§åŠ¨æ€ç”Ÿæˆæ•°æ®ç±»å‹çš„æ–¹æ³• |
    æ–‡äº«æ—¥å¿—</title>
<meta name="description" content="" />

<meta
  name="viewport"
  content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
/>
<link
  rel="shortcut icon"
  href="https://aiyou.life/favicon.ico?v=1691943745731"
/>

<link
  rel="stylesheet"
  href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
  integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"
  crossorigin="anonymous"
/>
<link
  rel="stylesheet"
  href="https://unpkg.com/papercss@1.6.1/dist/paper.min.css"
/>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css"
/>
<link rel="stylesheet" href="https://aiyou.life/styles/main.css" />
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism.css"
/>



<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  
<!-- <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script> -->

<style>
  .prev-mask {
    display: none;
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background-color: rgba(0, 0, 0, 0.6);
    z-index: 10000;
    justify-content: center;
    align-items: center;
  }
  .img-big {
    max-height: 70vh;
  }
  .post-content img {
    max-height: 500px;
  }
</style>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


  </head>
  <body>
    <div class="prev-mask">
      <div class="img-container">
        <div class="img-close">
          <img class="img-big" />
        </div>
      </div>
    </div>

    <nav class="navbar border fixed split-nav">
  <div class="nav-brand">
    <h3><a href="https://aiyou.life">æ–‡äº«æ—¥å¿—</a></h3>
  </div>
  <div class="collapsible">
    <input id="collapsible1" type="checkbox" name="collapsible1">
    <button>
      <label for="collapsible1">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </label>
    </button>
    <div class="collapsible-body">
      <ul class="inline">
        
          <li>
            
              <a href="/" class="menu">
                é¦–é¡µ
              </a>
            
          </li>
        
          <li>
            
              <a href="/archives" class="menu">
                å½’æ¡£
              </a>
            
          </li>
        
          <li>
            
              <a href="/tags" class="menu">
                æ ‡ç­¾
              </a>
            
          </li>
        
          <li>
            
              <a href="/post/about" class="menu">
                å…³äº
              </a>
            
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div id="top" class="row site">
      <div class="sm-12 md-8 col">
        <div class="paper">
          <article class="article">
            <h1>Restful-API çš„ä¸€ç§åŠ¨æ€ç”Ÿæˆæ•°æ®ç±»å‹çš„æ–¹æ³•</h1>
            <p class="article-meta">
              2021-08-31 
            </p>
            
            <div class="post-content"><p>ä½¿ç”¨ TypeScript å¼€å‘å‰ç«¯é¡¹ç›®ï¼Œå®Œå–„çš„ç±»å‹æ‰¹æ³¨æ˜¯éå¸¸æå‡å¼€å‘æ•ˆç‡çš„ã€‚ç„¶è€Œï¼Œå½“é‡åˆ° Restfulï¼Œä¼¼ä¹åªèƒ½ä¸º Restful è¿”å›çš„ JSON æ•°æ®æ‰‹åŠ¨ä¹¦å†™ç±»å‹ï¼Œéšç€æ¥å£è¶Šæ¥è¶Šå¤šï¼Œæ‰‹å†™ç±»å‹æ˜¯ç¹çä¸”ä½æ•ˆçš„ã€‚ æœ‰æ²¡æœ‰ä¸€ç§ç®€å•çš„æ–¹å¼ï¼Œå¯ä»¥æ‹¿åˆ°è¿”å›æ•°æ®çš„ç±»å‹å‘¢ï¼Ÿ</p>
<!-- more -->
<h2 id="json-ç±»å‹æ–‡ä»¶ç”Ÿæˆ">JSON ç±»å‹æ–‡ä»¶ç”Ÿæˆ</h2>
<h3 id="json-ç±»å‹">JSON ç±»å‹</h3>
<p>Json ä¸­æ•°æ®ç±»å‹æœ‰ 6 ç§: string ã€numberã€booleanã€arrayã€objectã€null</p>
<p>å…¶ä¸­ stringã€numberã€boolean çš„ç±»å‹å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>typeof</code> åˆ¤åˆ«ç±»å‹ã€‚</p>
<p>null æœ‰äº›å¤æ‚ï¼Œå®ƒå¯èƒ½æ˜¯å…¶ä»– 5 ä¸­ç±»å‹ä¸­çš„ä¸€ç§ï¼Œæ— æ³•åˆ¤æ–­å…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå› è€Œåªèƒ½å¡«å…… any</p>
<p>å¯¹äº objectï¼Œå®ƒå¯èƒ½ç”± Json çš„ 6 ç§æ•°æ®ç»“æ„ç»„æˆï¼Œå¯ä»¥ä½¿ç”¨é€’å½’éå†çš„æ–¹å¼ï¼Œæ¥åˆ¤æ–­ value çš„ç±»å‹</p>
<p>è€Œå¯¹äº array ï¼Œarray ä¸­çš„æ¯ä¸€é¡¹æ•°æ®ç»“æ„åº”å½“éƒ½æ˜¯ç›¸åŒçš„ï¼Œå› è€Œåªéœ€è¦å–å‡ºç¬¬ä¸€é¡¹è¿›è¡Œå¤„ç†ï¼Œå¤„ç†é€»è¾‘ä¸ä¸Šè¿°å‡ ç§ç±»å‹ç›¸åŒã€‚</p>
<h3 id="æ–‡ä»¶ç”Ÿæˆ">æ–‡ä»¶ç”Ÿæˆ</h3>
<p>å¯ä»¥ä½¿ç”¨ node fs apiï¼Œåˆ©ç”¨æ‹¼æ¥å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œå°† JSON ç±»å‹å¤„ç†åï¼Œè¾“å‡ºåˆ°ç±»å‹æ–‡ä»¶ä¸­ã€‚è¿™æ ·ç®€å•ä¸”æœ‰æ•ˆï¼Œä½†ä¸é‚£ä¹ˆä¼˜é›…ï¼Œä¸”æ˜“å‡ºé”™ã€‚</p>
<p>å¯ä»¥å€ŸåŠ© <a href="https://ts-morph.com/">ts-morph</a> è¿™ä¸ªåº“ï¼Œæ¥å®Œæˆç±»å‹çš„ç”Ÿæˆå’Œå¯¼å‡ºã€‚</p>
<p>ts-morph ä½¿ç”¨ä¼ªä»£ç å¦‚ä¸‹:</p>
<pre><code class="language-text">const project = createProject()
project.addInterface({ name, value }).setIsExport(true)
saveProject(project)
</code></pre>
<p>ç›¸æ¯” fs APIï¼Œts-morph ä½¿ç”¨æ›´ç®€å•</p>
<h2 id="restful-æ•´åˆ">Restful æ•´åˆ</h2>
<p>å¯ä»¥æ ¹æ® JSON æ•°æ®ç”Ÿæˆç±»å‹æ–‡ä»¶åï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œåœ¨è¯·æ±‚åº“çš„æ‹¦æˆªå™¨ä¸­ï¼Œæ‹¦æˆªå“åº”ï¼Œæ‰§è¡Œ JSON ç±»å‹æ–‡ä»¶ç”Ÿæˆã€‚ä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå‰ç«¯é¡¹ç›®ä¸­ï¼ŒNode API ä¸èƒ½ä½¿ç”¨ï¼Œå› ä¸ºä½ çš„ä»£ç æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨çš„ã€‚é‚£ä¹ˆæ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>
<h3 id="ç±»å‹ç”Ÿæˆå™¨è„šæœ¬">ç±»å‹ç”Ÿæˆå™¨è„šæœ¬</h3>
<p>æ—¢ç„¶å‰ç«¯é¡¹ç›®ä¸­ä¸èƒ½é›†æˆJSONç±»å‹æ–‡ä»¶ç”Ÿæˆå·¥å…·ï¼Œé‚£ä¹ˆå¯ä»¥ç¼–å†™ Node è„šæœ¬æ¥è§£å†³é—®é¢˜ã€‚åç«¯æä¾›ä¸€ä¸ªæ¥å£åï¼Œå‰ç«¯æ–°å¢ä¸€ä¸ªæ¥å£ï¼Œè„šæœ¬é…ç½®æ–‡ä»¶ä¹Ÿè¦æ³¨å†Œä¸€ä¸ªæ¥å£ï¼Œæœ€åè¿è¡Œä¸€ä¸‹è„šæœ¬å³å¯ã€‚</p>
<p>é‚£ä¹ˆçœ‹çœ‹è„šæœ¬éœ€è¦å®Œæˆå“ªäº›åŠŸèƒ½ã€‚</p>
<p>é¦–å…ˆè„šæœ¬éœ€è¦é›†æˆä¸€ä¸ªè¯·æ±‚åº“ï¼Œç”¨ä»¥å‘èµ·è¯·æ±‚ï¼Œæ¥æ”¶æœåŠ¡ç«¯çš„ JSON æ•°æ®ã€‚</p>
<p>ç„¶åè¿˜è¦é›†æˆä¸Šé¢çš„ JSONç±»å‹æ–‡ä»¶ç”Ÿæˆè„šæœ¬ã€‚</p>
<p>æ­¤å¤–ï¼Œè¿˜éœ€è¦ç»´æŠ¤ä¸€ä»½é…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­è¦æœ‰è¯·æ±‚å‚æ•°åˆ—è¡¨ï¼Œç”¨ä»¥åŠ¨æ€ç”Ÿæˆç±»å‹æ–‡ä»¶ã€‚ä¸ºäº†é¿å…åŒæ—¶å‘èµ·çš„è¯·æ±‚æ•°é‡å¤ªå¤šï¼Œå¯¼è‡´ç”µè„‘æ­»æœºï¼Œæˆ–è€…æœåŠ¡ç«¯å®•æœºï¼Œè¿˜è¦å¯¹è¯·æ±‚è¿›è¡Œå¹¶å‘æ§åˆ¶ã€‚</p>
<p>æ¯æ¬¡æ‰§è¡Œè„šæœ¬ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½ä¼šå†å‘é€ä¸€éï¼Œæ‰€ä»¥è¿˜è¦è€ƒè™‘æ£€æµ‹æ–‡ä»¶æ˜¯å¦ç”Ÿæˆï¼Œå†å»è¯·æ±‚ã€‚</p>
<p>è€ƒè™‘åˆ°å¯ç»´æŠ¤æ€§ï¼Œå»ºè®®å•ç‹¬ç»´æŠ¤ä¸€ä¸ª URL çš„æ˜ å°„æ–‡ä»¶ï¼Œåœ¨Nodeè„šæœ¬å’Œå‰ç«¯é¡¹ç›®ï¼Œå¼•ç”¨ URL æ–‡ä»¶çš„URL åœ°å€ã€‚</p>
<p>æœ‰äº†è¿™æ ·ä¸€ä¸ªè„šæœ¬ï¼Œæ¯æ¬¡æ–°å¢ä¸€ä¸ªæ¥å£æ—¶ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ä¸€ä¸‹æ¥å£å’Œè¯·æ±‚å‚æ•°ï¼Œç„¶åæ‰‹åŠ¨æ‰§è¡Œä¸€ä¸‹è„šæœ¬ã€‚è¿™æ ·ä¹Ÿä¸å¤ªæ–¹ä¾¿ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://github.com/paulmillr/chokidar">chokidar</a> ç›‘å¬æ–‡ä»¶å˜æ›´ï¼Œä½¿ç”¨ shelljs æ¥æ‰§è¡Œè„šæœ¬ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„æ­¥éª¤ç¹çä¸”å¤æ‚ï¼Œç»´æŠ¤è¿™æ ·ä¸€ä¸ªå¤æ‚é…ç½®æ–‡ä»¶ï¼Œä¼šè®©äººæœ›è€Œå´æ­¥ã€‚å¹¶ä¸”è¿™æ ·çš„é…ç½®æ–‡ä»¶å¯¹äºä¸€äº›å¤æ‚çš„è¯·æ±‚ï¼Œæ¶‰åŠåˆ°çš„ Token æ ¡éªŒï¼Œ Post çš„ Body å¤„ç†ï¼Œå“åº”çš„ Data çš„å¤„ç†ç­‰ç­‰éƒ½è¦åŒºåˆ«ä¸å‰ç«¯é¡¹ç›®ï¼Œå†å•ç‹¬å¤„ç†ä¸€éã€‚</p>
<p>æœ‰æ²¡æœ‰æ›´å¥½çš„åŠæ³•ï¼Œæ¥å®Œæˆç±»å‹ç”Ÿæˆçš„ç›®çš„ï¼Ÿ</p>
<h3 id="server-clinet-ç±»å‹ç”Ÿæˆå™¨">Server-Clinet ç±»å‹ç”Ÿæˆå™¨</h3>
<p>å†™è¿™æ ·ä¸€ä¸ªè„šæœ¬ï¼Œä¸»è¦çš„éš¾ç‚¹åœ¨äºNodeè„šæœ¬æ€ä¹ˆä¾¿æ·çš„æ‹¿åˆ°å‰ç«¯é¡¹ç›®çš„å“åº”æ•°æ®ï¼Œä¹Ÿå°±æ˜¯å‰ç«¯æ‹¿åˆ°æ•°æ®åæ€ä¹ˆé€šçŸ¥åˆ°è„šæœ¬ï¼Ÿ</p>
<p>è¿™ä¹ˆä¸€æƒ³ï¼Œäº‹æƒ…å°±ç®€å•äº†ï¼Œå¦‚æœ Node è„šæœ¬ä¸­å¼€å¯ä¸€ä¸ª HTTP Serverï¼Œå‰ç«¯æ‹¿åˆ°æ•°æ®åï¼Œå†å‘ HTTP Server å‘èµ·ä¸€ä¸ª POST è¯·æ±‚ï¼Œå°†ä¸€äº›å‚æ•°æºå¸¦è¿‡å»ï¼ŒæŒ‡æŒ¥ HTTP Server å‘ç›®æ ‡ç›®å½•ç”Ÿæˆç±»å‹æ–‡ä»¶å³å¯ã€‚</p>
<p>ä½†è¿™ä¸€å¥—æµç¨‹è¿˜æœ‰ä¸ªç¼ºç‚¹ï¼Œç±»å‹æ–‡ä»¶æ˜¯â€œè¿è¡Œæ—¶â€ç”Ÿæˆçš„ï¼Œç”Ÿæˆç±»å‹æ–‡ä»¶å‰ï¼Œéœ€è¦å‰ç«¯é¡¹ç›®å…ˆè°ƒç”¨ä¸€æ¬¡è¯·æ±‚ã€‚ä½†æ˜¯ï¼Œè¿™ä¸€ç‚¹ç¼ºç‚¹æ— ä¼¤å¤§é›…ï¼Œå¼€å‘ä»£ç æ—¶ï¼Œè‚¯å®šéœ€è¦å…ˆæµ‹è¯•æ¥å£èƒ½ä¸èƒ½é€šä»€ä¹ˆçš„ã€‚</p>
<h2 id="æ•ˆæœå±•ç¤º">æ•ˆæœå±•ç¤º</h2>
<p>åŸºäºå‡ å¤©çš„å°è¯•ï¼Œæˆ‘å¼€å‘äº†å‡ ä¸ªåº“ï¼Œå®Œæˆäº†è¿™æ ·ä¸€ä»¶äº‹æƒ…ï¼Œæœ€åçœ‹ demo çš„æ•ˆæœï¼Œè¿˜ä¸é”™ã€‚</p>
<h3 id="demo-é¡¹ç›®">Demo é¡¹ç›®</h3>
<p>æˆ‘åŸºäº Vite React TypeScript å†™äº†ä¸€ä¸ª demo é¡¹ç›®ï¼š<a href="https://github.com/xdoer/restful-types-generate-example">restful-types-generate-example</a>ã€‚</p>
<p>clone é¡¹ç›®åï¼Œè¿è¡Œ yarn å®‰è£…, yarn dev å¯åŠ¨é¡¹ç›®ï¼Œç‚¹å‡»é¡µé¢æŒ‰é’®ï¼Œå‘èµ·è¯·æ±‚åå³å¯çœ‹åˆ°æ•ˆæœã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://aiyou.life/post-images/1630407294021.gif" alt="" loading="lazy"></figure>
<h3 id="jsontypesgenerator">JsonTypesGenerator</h3>
<p><a href="https://github.com/xdoer/json-types-generator">json-types-generator</a> æ˜¯æ ¹æ®ç¬¬ä¸€å°èŠ‚ä¸­ä»‹ç»çš„åŸç†å®Œæˆçš„</p>
<p>ä½¿ç”¨æ–¹å¼å¦‚ä¸‹:</p>
<pre><code class="language-ts">import jsonTypesGenerator from 'json-types-generator'

const json = { a: { b: 1, c: { d: true } } }

jsonTypesGenerator({
   data: json,
   outPutPath: '/User/xdoer/types.ts',
   rootInterfaceName: 'ChinaRegion',
   customInterfaceName(key, value, data) {
      if (key === 'b') return 'Province'
   },
})
</code></pre>
<p>ä¸Šé¢çš„ä»£ç ï¼Œå°†ä¼šåœ¨ <code>/User/xdoer/types.ts</code> æ–‡ä»¶ä¸­ç”Ÿæˆå¯¼å‡º interface ä¸º <code>ChinaRegion</code> çš„ç±»å‹æ–‡ä»¶ï¼Œäº§ç”Ÿçš„ä¸­é—´ inteface åç§°ä¸º <code>Province</code>ï¼Œä¸­é—´äº§ç‰©é»˜è®¤çš„ interface åç§°ä¸º key çš„å¤§å†™</p>
<pre><code class="language-ts">&lt;!----/User/xdoer/types.ts----&gt;
export interface ChinaRegion {
    a: Province
}

export interface Province {
    b: number
    c: C
}

export interface C {
    d: boolean
}
</code></pre>
<h3 id="responsetypesserver">ResponseTypesServer</h3>
<p><a href="https://github.com/xdoer/PreQuest/tree/main/packages/response-types-server">response-types-server</a> æ˜¯ä¸Šæ–‡æåˆ°çš„ Server-Clinet ç±»å‹ç”Ÿæˆå™¨ ä¸­çš„ Server éƒ¨åˆ†ã€‚åªéœ€è¦å‘è¿™ä¸ªServer å‘é€ POST è¯·æ±‚ï¼Œå³å¯ç”Ÿæˆç±»å‹ã€‚</p>
<p>ä½¿ç”¨æ–¹å¼å¦‚ä¸‹:</p>
<pre><code class="language-ts">import server from '@prequest/response-types-server'

// é»˜è®¤å¼€å¯çš„ç«¯å£ä¸º 10086
server()

// ä½ å¯ä»¥é€šè¿‡ä¼ å‚æŒ‡å®šç«¯å£
server({ port: 10010 })
</code></pre>
<p>å‘é€çš„è¯·æ±‚ï¼Œè·¯å¾„ä»»æ„ï¼Œ POST è¯·æ±‚å‚æ•°ä¸º:</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ç±»å‹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>outPutDir</td>
<td>string</td>
<td>ç±»å‹æ–‡ä»¶è¾“å‡ºç›®å½•</td>
</tr>
<tr>
<td>outPutName</td>
<td>string</td>
<td>æ–‡ä»¶åç§°</td>
</tr>
<tr>
<td>overwrite</td>
<td>boolean</td>
<td>æ–‡ä»¶å¯å¤å†™</td>
</tr>
<tr>
<td>data</td>
<td>Json</td>
<td>è¦è§£æçš„ Json æ•°æ®</td>
</tr>
<tr>
<td>interfaceName</td>
<td>string</td>
<td>å¯¼å‡ºçš„æ¥å£åç§°</td>
</tr>
</tbody>
</table>
<h3 id="responsetypesclient">ResponseTypesClient</h3>
<p><a href="https://github.com/xdoer/PreQuest/tree/main/packages/response-types-client">response-types-client</a> æ˜¯ä¸Šæ–‡æåˆ°çš„ Server-Clinet ç±»å‹ç”Ÿæˆå™¨ ä¸­çš„ Client éƒ¨åˆ†ã€‚å®ƒæ˜¯ä¸€ä¸ªä¸­é—´ä»¶ Wrapperï¼Œåªè¦å°†å…¶æ³¨å†Œåˆ°è¯·æ±‚åº“ä¸­é—´ä»¶ä¸­ï¼Œå³å¯å‘èµ·è¯·æ±‚ã€‚</p>
<p>ä¸‹é¢çš„ demo ä½¿ç”¨äº†æˆ‘è‡ªå·±å°è£…çš„è¯·æ±‚åº“ PreQuestï¼ŒåŸºäº Koa ä¸­é—´ä»¶æ¨¡å‹çš„è¯·æ±‚åº“åº”è¯¥éƒ½å¯ä»¥ä½¿ç”¨ï¼Œæ¯”å¦‚è¯´ Umi-Requestã€‚å¯¹äº Axiosï¼Œéœ€è¦è‡ªå·±åœ¨æ‹¦æˆªå™¨ä¸­å®ç°ï¼Œä¹Ÿéå¸¸å®¹æ˜“ã€‚</p>
<p>ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="language-ts">import { create, Request, Response } from '@prequest/xhr'
import generateMiddleware, { TypesGeneratorInject } from '@prequest/response-types-client'

// ç”Ÿæˆä¸­é—´ä»¶
const middleware = generateMiddleware&lt;Request, Response&gt;({
  enable: process.env.NODE_ENV === 'development',
  httpAgent: create({ path: 'http://localhost:10010/' }),
  outPutDir: 'src/api-types'
  parseResponse(res) {
    // res åº”å½“è¿”å›æ¥å£ data æ•°æ®
    return res as any
  },
  typesGeneratorConfig(req, res) {
    const { path } = req
    const { data } = res

    if (!path) throw new Error('path not found')

    // æ ¹æ®è¯·æ±‚è·¯å¾„ç”Ÿæˆæ–‡ä»¶åå’Œç±»å‹å¯¼å‡ºåç§°
    const outPutName = path.replace(/.*\/(\w+)/, (_, __) =&gt; __)
    const interfaceName = outPutName.replace(/^[a-z]/, g =&gt; g.toUpperCase())

    return {
      data,
      outPutName,
      interfaceName,
      overwrite: true,
    }
  },
})

// æ³¨å…¥ TypesGeneratorInjectï¼Œ å¯åœ¨è¯·æ±‚æ—¶ï¼Œæ ¹æ® rewriteType å‚æ•°å¼ºåˆ¶é‡æ–°ç”Ÿæˆç±»å‹æ–‡ä»¶
export const prequest = create&lt;TypesGeneratorInject, {}&gt;({ baseURL: 'http://localhost:3000' })
// æ³¨å†Œä¸­é—´ä»¶
prequest.use(middleware)
</code></pre>
<h3 id="responsetypesgenerator">ResponseTypesGenerator</h3>
<p>æ­¤å¤–ï¼Œè¿˜æœ‰åŸºäºä¸Šæ–‡ &quot;ç±»å‹ç”Ÿæˆå™¨è„šæœ¬&quot; ä¸€èŠ‚ä¸­çš„åŸç†ï¼Œè¿›è¡Œäº†ä¸€ä¸ªå¤±è´¥çš„å°è¯•:<a href="https://github.com/xdoer/PreQuest/tree/main/packages/response-types-generator">response-types-generator</a>ï¼Œä¹Ÿä¸€å¹¶æ”¾åˆ°è¿™é‡Œï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>ä»¥ä¸ŠåŸºäºæˆ‘æµ…è–„çš„å­¦è¯†è¿›è¡Œçš„ä¸€äº›å¯¹ Restful å“åº”çš„ JSON æ•°æ®ç±»å‹ç”Ÿæˆçš„ä¸€äº›æ¢ç´¢ï¼Œå¦‚æœæ‚¨å‘ç°äº†æ–‡ä¸­çš„ä¸€äº›é”™è¯¯ä¹‹å¤„ï¼Œæˆ–è€…æœ‰æ›´ç®€ä¾¿çš„æ–¹å¼ç”Ÿæˆç±»å‹æ–‡ä»¶ï¼Œæ¬¢è¿åœ¨è¯„è®ºé‡Œæå‡ºæ¥ï¼Œå¤§å®¶ä¸€èµ·æ¢è®¨ã€‚</p>
</div>
          </article>
          <div class="simple-share">
            <a class="share-item" href="javascript:share.qzone()">QQç©ºé—´</a>
            <a class="share-item" href="javascript:share.weibo()">å¾®åš</a>
            <a class="share-item" href="javascript:share.facebook()"
              >Facebook</a
            >
            <a class="share-item" href="javascript:share.twitter()">Twitter</a>
          </div>
        </div>
        <div class="paper" data-aos="fade-in">
          
          <div class="next-post">
            <div class="next">
              ä¸‹ä¸€ç¯‡
            </div>
            <a href="https://aiyou.life/post/SV2erlm_4/">
              <h3 class="post-title">å‡ ä¸ªDemo çœ‹æ‡‚ ESM ä¸ CommonJS å·®å¼‚</h3>
            </a>
          </div>
          
        </div>
         
        <div class="paper" data-aos="fade-in">
          <div id="gitalk-container"></div>
        </div>
          
      </div>

      <div class="sm-12 md-4 col sidebar">
  <div class="paper info-container">
    <img
      src="https://aiyou.life/images/avatar.png?v=1691943745731"
      class="no-responsive avatar"
    />
    <div class="text-muted"></div>
    <div class="social-container">
       
      <a href="https://github.com/xdoer" target="_blank">
        <i class="fab fa-github"></i>
      </a>
        
      <a href="https://twitter.com/xxdoer1" target="_blank">
        <i class="fab fa-twitter"></i>
      </a>
        
      <a href="https://weibo.com/u/7407806835" target="_blank">
        <i class="fab fa-weibo"></i>
      </a>
          
      <a href="https://www.facebook.com/xxdoer" target="_blank">
        <i class="fab fa-facebook"></i>
      </a>
       
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      æœ€æ–°æ–‡ç« 
    </div>
    <div class="row">
      <ul>
         
        <li>
          <a href="https://aiyou.life/post/7w-Gt8VOo/">è¿‘å¹´æ„Ÿæ…¨ä¸€ä¸‹</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/WTBK_yMNR/">è´¦æœ¬å¼€å‘å°è®°</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/7Ta0APQTd/">è®©ç”Ÿæ´»äº•äº•æœ‰æ¡</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/Fjnj0JDZ5/">å¯Œæ–‡æœ¬ç¼–è¾‘å™¨è½¬ä¸ºå—æ§ç»„ä»¶çš„ä¸€ç§æ€è·¯</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/zPGtmQi-5/">TS çš„ä¸€äº›é«˜çº§ç±»å‹å†™æ³•</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/QqaRhC3Gf/">Restful-API çš„ä¸€ç§åŠ¨æ€ç”Ÿæˆæ•°æ®ç±»å‹çš„æ–¹æ³•</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/SV2erlm_4/">å‡ ä¸ªDemo çœ‹æ‡‚ ESM ä¸ CommonJS å·®å¼‚</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/UNWTwtWxa/">Taro è‡ªå®šä¹‰ showModal</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/iWhkaOqqO/">å†™ä¸€ä¸ªå€’è®¡æ—¶ğŸ˜¢ï¼Ÿ</a>
        </li>
          
        <li>
          <a href="https://aiyou.life/post/4XYWTWTx/">æƒ³åˆ°çš„ä¸€äº›å¾ˆå¥½çš„é¢è¯•é¢˜</a>
        </li>
                                     
      </ul>
    </div>
  </div>
  <div class="paper">
    <div class="sidebar-title">
      æ ‡ç­¾åˆ—è¡¨
    </div>
    <div class="row">
      
      <a
        href="https://aiyou.life/tag/df67loo-n/"
        class="badge secondary"
      >
        ç¬”è®°
      </a>
      
      <a
        href="https://aiyou.life/tag/K1r5vpFd_/"
        class="badge success"
      >
        å‰ç«¯
      </a>
      
      <a
        href="https://aiyou.life/tag/E75leUW9b/"
        class="badge success"
      >
        typescript
      </a>
      
      <a
        href="https://aiyou.life/tag/rSf0tu2pz/"
        class="badge warning"
      >
        React
      </a>
      
      <a
        href="https://aiyou.life/tag/TfrzxMzWY/"
        class="badge secondary"
      >
        å°ç¨‹åº
      </a>
      
      <a
        href="https://aiyou.life/tag/TDgBvCzI8/"
        class="badge warning"
      >
        javascript
      </a>
      
      <a
        href="https://aiyou.life/tag/g_6wyy_ol/"
        class="badge secondary"
      >
        ç½‘ç»œ
      </a>
      
      <a
        href="https://aiyou.life/tag/jp41-NU1u/"
        class="badge secondary"
      >
        ReactNative
      </a>
      
      <a
        href="https://aiyou.life/tag/X7Cdzy-Hu/"
        class="badge "
      >
        åšå®¢
      </a>
      
    </div>
  </div>
  <div class="paper">
    Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> |
    <a class="rss" href="https://aiyou.life/atom.xml" target="_blank"
      >RSS</a
    >
  </div>
</div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
<!-- <script src="//cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-bash.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-typescript.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-jsx.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-tsx.min.js"></script> -->
<script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">
  AOS.init()

  // hljs.initHighlightingOnLoad()
</script>

<script type="application/javascript">
  // ä¸€è¨€
  function oneWord(element) {
    if (!element) return
    const xhr = new XMLHttpRequest()
    xhr.open('get', 'https://v1.hitokoto.cn/')
    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4) {
        element.innerText = JSON.parse(xhr.responseText).hitokoto
      }
    }
    xhr.send()
  }
  oneWord(document.querySelector('.text-muted'))
</script>

<script type="application/javascript">
  // åˆ†äº«
  var SimpleShare = function (options) {
    // get share content
    options = options || {}
    var url = options.url || window.location.href
    var title = options.title || document.title
    var content = options.content || ''
    var pic = options.pic || ''

    // fix content format
    url = encodeURIComponent(url)
    title = encodeURIComponent(title)
    content = encodeURIComponent(content)
    pic = encodeURIComponent(pic)

    // share target url
    var qzone =
      'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={url}&title={title}&pics={pic}&summary={content}'
    var weibo =
      'http://service.weibo.com/share/share.php?url={url}&title={title}&pic={pic}&searchPic=false'
    var tqq =
      'http://share.v.t.qq.com/index.php?c=share&a=index&url={url}&title={title}&appkey=801cf76d3cfc44ada52ec13114e84a96'
    var renren =
      'http://widget.renren.com/dialog/share?resourceUrl={url}&srcUrl={url}&title={title}&description={content}'
    var douban =
      'http://www.douban.com/share/service?href={url}&name={title}&text={content}&image={pic}'
    var facebook =
      'https://www.facebook.com/sharer/sharer.php?u={url}&t={title}&pic={pic}'
    var twitter = 'https://twitter.com/intent/tweet?text={title}&url={url}'
    var linkedin =
      'https://www.linkedin.com/shareArticle?title={title}&summary={content}&mini=true&url={url}&ro=true'
    var weixin = 'http://qr.topscan.com/api.php?text={url}'
    var qq =
      'http://connect.qq.com/widget/shareqq/index.html?url={url}&desc={title}&pics={pic}'

    // replace content functions
    function replaceAPI(api) {
      api = api.replace('{url}', url)
      api = api.replace('{title}', title)
      api = api.replace('{content}', content)
      api = api.replace('{pic}', pic)

      return api
    }

    // share target
    this.qzone = function () {
      window.open(replaceAPI(qzone))
    }
    this.weibo = function () {
      window.open(replaceAPI(weibo))
    }
    this.tqq = function () {
      window.open(replaceAPI(tqq))
    }
    this.renren = function () {
      window.open(replaceAPI(renren))
    }
    this.douban = function () {
      window.open(replaceAPI(douban))
    }
    this.facebook = function () {
      window.open(replaceAPI(facebook))
    }
    this.twitter = function () {
      window.open(replaceAPI(twitter))
    }
    this.linkedin = function () {
      window.open(replaceAPI(linkedin))
    }
    this.qq = function () {
      window.open(replaceAPI(qq))
    }
    this.weixin = function (callback) {
      if (!callback) {
        window.open(replaceAPI(weixin))
      } else {
        callback(replaceAPI(weixin))
      }
    }
  }
  var share = new SimpleShare()
</script>



<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script>
  var gitalk = new Gitalk({
    clientID: 'f9e29934c5621e13bb13',
    clientSecret: '6ca4b35e60834188ea98ca3be6fba3c21b5ad34a',
    repo: 'xdoer.github.io',
    owner: 'xdoer',
    admin: ['xdoer'],
    id: location.pathname.substring(0, 49), // Ensure uniqueness and length less than 50
    distractionFreeMode: false, // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')
</script>
  
<script>
  // ç‚¹å‡»æ–‡ç« å†…éƒ¨å›¾ç‰‡æŸ¥çœ‹å¤§å›¾
  const contentImagesEles = [...document.querySelectorAll('.post-content img')]
  const maskEle = document.querySelector('.prev-mask')
  const containerEle = document.querySelector('.image-container')
  const imgCloseEle = document.querySelector('.img-close')
  const imgBigEle = document.querySelector('.img-big')

  contentImagesEles.forEach((ele) => {
    ele.style

    ele.addEventListener('click', () => {
      const { currentSrc } = ele
      imgBigEle.src = currentSrc
      maskEle.style.display = 'flex'
    })
  })

  imgCloseEle.addEventListener('click', () => {
    maskEle.style.display = 'none'
  })
</script>

  </body>
</html>
